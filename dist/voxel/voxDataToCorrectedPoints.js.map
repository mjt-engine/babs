{"version":3,"file":"voxDataToCorrectedPoints.js","sourceRoot":"","sources":["../../src/voxel/voxDataToCorrectedPoints.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,MAAM,EAAE,MAAM,kBAAkB,CAAC;AAC1C,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,oBAAoB,CAAC;AAIpD,MAAM,CAAC,MAAM,wBAAwB,GAAG,CAAC,OAAgB,EAAE,EAAE;IAC3D,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC;IAC/B,MAAM,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC;IACrB,MAAM,sBAAsB,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,CAAC;IAC7C,MAAM,sBAAsB,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,CAAC;IAC7C,kEAAkE;IAClE,MAAM,sBAAsB,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,CAAC;IAC7C,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;QACvB,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;QAE/B,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,GAAG,sBAAsB,CAAC;QAC7D,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,GAAG,sBAAsB,CAAC;QAE7D,oBAAoB;QACpB,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,KAAK,GAAG,sBAAsB,CAAC;QAE9D,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;IAC5C,CAAC,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["import type { VoxData } from \"@mjt-engine/magica-voxels\";\nimport type { Point3} from \"@mjt-engine/math\";\nimport { toVec3 } from \"@mjt-engine/math\";\nimport { tuple2, tuple3 } from \"@mjt-engine/object\";\n\nexport type Point3ColorIndex = [Point3, number];\n\nexport const voxDataToCorrectedPoints = (voxData: VoxData) => {\n  const { XYZI, SIZE } = voxData;\n  const scale = SIZE.z;\n  const xVoxelCenterCorrection = 1 / scale / 2;\n  const yVoxelCenterCorrection = 1 / scale / 2;\n  // const zVoxelCenterCorrection = (1 / scale) * 2 + 1 / scale / 2;\n  const zVoxelCenterCorrection = 1 / scale / 2;\n  return XYZI.map((xyzi) => {\n    const [x, y, z] = toVec3(xyzi);\n\n    const xx = (x - SIZE.x / 2) / scale + xVoxelCenterCorrection;\n    const yy = (y - SIZE.y / 2) / scale + yVoxelCenterCorrection;\n\n    // TODO make +z 'up'\n    const zz = (z - SIZE.z / 2) / -scale - zVoxelCenterCorrection;\n\n    return tuple2(tuple3(xx, yy, zz), xyzi.i);\n  });\n};\n"]}